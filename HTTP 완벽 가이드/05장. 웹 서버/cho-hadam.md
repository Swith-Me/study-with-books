# [05장] 웹 서버

<br />

## 다채로운 웹 서버

'웹 서버'라는 용어는 웹 서버 소프트웨어와 웹페이지 제공에 특화된 장비 양쪽 모두를 가리킨다.

### 웹 서버 구현

웹 서버는 HTTP 및 그와 관련된 TCP 처리를 구현한 것이다.  
웹 서버는 자신이 제공하는 리소스를 관리하고 웹 서버를 설정, 통제, 확장하기 위한 관리 기능을 제공한다.

### 다목적 소프트웨어 웹 서버

다목적 소프트웨어 웹 서버는 네트워크에 연결된 표준 컴퓨터 시스템에서 동작한다.  
아파치, nginx 등

### 임베디드 웹 서버

임베디드 웹 서버는 일반 소비자용 제품에 내장될 목적으로 만들어진 작은 웹 서버이다.  
프린터, 가전제품 등

<br />

## 간단한 펄 웹 서버

<br />

## 진짜 웹 서버가 하는 일

1. 커넥션을 맺는다
2. 요청을 받는다
3. 요청을 처리한다
4. 리소스에 접근한다
5. 응답을 만든다
6. 응답을 보낸다
7. 트랜잭션을 로그로 남긴다

<br />

## 1단계: 클라이언트 커넥션 수락

- 새 커넥션 다루기
- 클라이언트 호스트 명 식별
- ident를 통해 클라이언트 사용자 알아내기

<br />

## 2단계: 요청 메시지 수신

- 메시지의 내부 표현
- 커넥션 입력/출력 처리 아키텍처
  - 단일 스레드 웹 서버  
    한 번에 하나씩 요청을 처리  
    구현하기 간단하지만 처리 도중에 모든 다른 커넥션 무시
  - 멀티프로세스와 멀티스레드 웹 서버  
    여러 요청을 동시에 처리하기 위해 여러 개의 프로세스 혹은 고효율 스레드 할당
  - 다중 I/O 서버
  - 다중 멀티스레드 웹 서버

<br />

## 3단계: 요청 처리

<br />

## 4단계: 리소스의 매핑과 접근

- Docroot
- 디렉터리 목록
- 동적 콘텐츠 리소스 매핑  
  웹 서버들 중에서 애플리케이션 서버라고 불리는 것들은 웹 서버를 복잡한 백엔드 애플리케이션과 연결하는 일을 한다
- 서버사이드 인클루드`Server-Side Includes, SSI`
- 접근 제어

<br />

## 5단계: 응답 만들기

- 응답 엔터티

- MIME 타입 결정하기

  - mime.types  
    파일 이름의 확장자 사용
  - 매직 타이핑`Magic typing`  
    파일의 내용을 검사해서 알려진 패턴에 대한 테이블에 해당하는 패턴이 있는지 찾음
  - 유형 명시`Explicit typing`  
    파일 확장자나 내용에 상관없이 어떤 MIME 타입을 갖도록 설정
  - 유형 협상`Type negotiation`  
    어떤 웹 서버는 한 리로스가 여러 종류의 문서 형식에 속하도록 설정할 수 있음

- 리다이렉션
  - 영구히 리소스가 옮겨진 경우
  - 임시로 리소스가 옮겨진 경우
  - URL 증강
  - 부하 균형
  - 친밀한 다른 서버가 있을 때
  - 디렉터리 이름 정규화

<br />

## 6단계: 응답 보내기

<br />

## 7단계: 로깅
