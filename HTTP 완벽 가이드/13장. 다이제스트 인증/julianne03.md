# 13. 다이제스트 인증

<br>

## 13.0 Intro

- 기본 인증은 편리하고 유연하지만 전혀 안전하지 않다.
- 다이제스트 인증은 기본 인증과 호환되는 더 안전한 대체재로서 개발되었다.
- 다이제스트 인증은 널리 쓰이지는 않지만, 그 개념은 보안 트랜잭션을 구현하고자 하는 이들에게 여전히 유용하다.

<br>

## 13.1 다이제스트 인증의 개선점

- 다이제스트 인증은 기본 인증의 가장 심각한 결함을 수정한 또 다른 HTTP 인증 프로토콜이다.
- 다음은 다이제스트 인증의 특징이다.

1. 비밀번호를 절대로 네트워크를 통해 평문으로 전송하지 않는다.
2. 인증 체결을 가로채서 재현하려는 악의적인 사람들을 차단한다.
3. 구현하기에 따라서, 메시지 내용 위조를 막는 것도 가능하다.
4. 그 외 몇몇 잘 알려진 형태의 공격을 막는다.

<br>

### 13.1.1 비밀번호를 안전하게 지키기 위해 요약 사용하기

- 다이제스트 인증의 좌우명은 "절대로 비밀번호를 네트워크를 통해 보내지 않는다"이다.
- 비밀번호를 보내는 대신, 클라이언트는 비밀번호를 비가역적으로 뒤섞은 '지문' 혹은 '요약'을 보낸다.
- 클라이언트와 서버는 둘 다 비밀번호를 알고 있으므로, 서버는 클라이언트가 보낸 요약이 비밀번호에 알맞게 대응하는지 검사할 수 있다.

<br>

### 13.1.2 단방향 요약

- 요약은 "정보 본문의 압축"이다.
- 요약은 단방향 함수로 동작하고, 일반적으로 입력 가능한 무한 가지와 모든 입력값들을 유한한 범위의 압축으로 변환한다.
- 요약 함수는 보통 암호 체크섬으로 불리며, 단방향 해시 함수이거나 지문 함수이다.

<br>

### 13.1.3 재전송 방지를 위한 난스(nonce) 사용

- 단방향 요약은 비밀번호를 그대로 전송해야 할 필요성에서 우리를 해방시켜 준다.
- 불행히도, 불투명 비밀번호 자체로는 우리를 위험에서 지켜주지 못한다.
- 재전송 공격을 방지하기 위해서 서버는 클라이언트에게 난스라고 불리는 특별한, 그리고 자주 바뀌는 증표를 건네준다.
- 다이제스트 인증은 난스를 사용할 것을 요구한다.
- 이유는 자잘한 재전송 공격들이 난스를 쓰지 않는 다이제스트 인증을 실질적으로 기본 인증만큼 허약한 것으로 만들기 때문이다.

<br>

### 13.1.4 다이제스트 인증 핸드셰이크

- HTTP 다이제스트 인증 프로토콜은 기본 인증에서 사용하는 것과 비슷한 헤더를 사용하는, 강화된 버전의 인증이다.
- 기존 헤더에 몇몇 새 옵션이 추가되었고, 선택적인 헤더인 Authorization-Info가 새로 추가되었다.

<br>

1. 서버는 난스 값을 계산한다.
2. 서버는 난스를 WWW-Authenticate 인증요구 메시지에 담아, 서버가 지원하는 알고리즘 목록과 함께 클라이언트에 전송한다.
3. 클라이언트는 알고리즘을 선택하고 비밀번호와 그 외 데이터에 대한 요약을 계산한다.
4. 클라이언트는 Authorization 메시지에 요약을 담아 서버에게 돌려준다.
5. 서버는 요약, 선택한 알고리즘, 그 외 보조 데이터들을 받고, 클라이언트가 했던 그대로 요약을 계산한다.

<br>

---

13.2부터 매우 deep 내용인 관계로 요약 계산부터 생략함.