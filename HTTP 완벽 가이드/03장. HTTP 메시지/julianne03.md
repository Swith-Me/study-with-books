# 03. HTTP 메시지

## 3.0 Intro

- HTTP가 인터넷의 배달원이라면, HTTP 메시지는 무언가를 담아 보내는 소포
- 이번 장에서는 어떻게 메시지를 만들고 이해하는지에 대해 말해준다.

<br>

## 3.1 메시지의 흐름

- HTTP 메시지는 HTTP 애플리케이션 간에 주고받는 데이터의 블록들이다.
- 클라이언트, 서버, 프락시 사이를 흐른다.
- '인바운드', '아웃바운드', '업스트림', '다운스트림'은 메시지의 방향을 의미하는 용어다.

**메시지 구조**

- 메시지의 내용과 의미를 설명하는 텍스트 메타 정보
- 그 다음 선택적으로 데이터가 올 수 있음

<br>

### 3.1.1 메시지는 원 서버 방향을 인바운드로 하여 송신된다.

- 메시지가 원 서버로 향하는 것 = 인바운드로 이동하는 것
- 모든 처리가 끝난 뒤에 메시지가 사용자 에이전트로 돌아오는 것 = 아웃바운드로 이동하는 것

<br>

### 3.1.2 다운스트림으로 흐르는 메시지

- 모든 메시지는 다운스트림으로 흐른다.
- 메시지의 발송자는 수신자의 업스트림이다.

<br>

## 3.2 메시지의 각 부분

- 메시지는 시작줄, 헤더 블록, 본문 이렇게 세 부분으로 이루어진다.
- **시작줄**은 이것이 어떤 메시지인지 서술한다.
- **헤더 블록**은 속성을, **본문**은 데이터를 담고 있다.(없을 수도 있음)
- 시작줄과 헤더는 줄 단위로 분리된 아스키 문자열이다.
- 헤더에서 `Content-Type` 줄은 본문이 무엇인지 말해준다.
- 헤더에서 `Content-length` 줄은 본문의 크기를 말해준다.

<br>

### 3.2.1 시작줄

- 모든 HTTP 메시지는 시작줄로 시작한다.
- 요청 메시지의 시작줄은 무엇을 해야 하는지 말해준다.
- ex. `GET /test/hi-there.txt HTTP/1.1`
- 응답 메시지의 시작줄은 무슨 일이 일어났는지 말해준다.
- ex. `HTTP/1.0 200 OK`

<br>

## 3.3 메시지 문법

- 모든 HTTP 메시지는 요청 메시지와 응답 메시지로 분류된다.
- **요청 메시지**는 웹 서버에 어떤 동작을 요구한다.
- **응답 메시지**는 요청의 결과를 클라이언트에게 돌려준다.

<br>

### 3.3.1 요청 메시지의 형식

```
<메서드> <요청 URL> <버전>
<헤더>

<엔터티 본문>
```

<br>

### 3.3.2 응답 메시지의 형식

```
<버전> <상태 코드> <사유 구절>
<헤더>

<엔터티 본문>
```

<br>

### 3.3.3 메서드

- 클라이언트 측에서 서버가 리소스에 대해 수행해주길 바라는 동작이다.
  > <img src="https://user-images.githubusercontent.com/59498977/129479922-842da73a-81a0-4386-b1d2-a23aa9dc606f.png" width="400">
  >
  > 출처: https://simple-ing.tistory.com/8?category=962176

<br>

### 3.3.4 요청 URL

- 요청 대상이 되는 리소스를 지칭하는 완전한 URL 혹은 URL의 경로 구성요소

<br>

### 3.3.5 버전

- 이 메시지에서 사용 중인 HTTP의 버전

<br>

### 3.3.6 상태 코드

- 요청 중에 무엇이 일어났는지 설명하는 세 자리의 숫자
- 100-199: 정보성 상태 코드
- 200-299: 성공 상태 코드
- 300-399: 리다이렉션 상태 코드
- 400-499: 클라이언트 에러 상태 코드
- 500-599: 서버 에러 상태 코드

<br>

| 상태 코드 | 사유 구절    | 의미                                               |
| --------- | ------------ | -------------------------------------------------- |
| 200       | OK           | 성공! 요청한 모든 데이터는 응답 본문에 들어있다.   |
| 401       | Unauthorized | 사용자 이름과 비밀번호를 입력해야 한다.            |
| 404       | Not Found    | 서버는 요청한 URL에 해당하는 리소스를 찾지 못했다. |

<br>

### 3.3.7 사유 구절(reason-phrase)

- 숫자로 된 상태 코드의 의미를 사람이 이해할 수 있게 설명해주는 짧은 문구
- ex. `HTTP/1.0 200 OK`

<br>

### 3.3.8 헤더들

- 이름, 콜론, 선택적인 공백, 값, CRLF가 순서대로 나타나는 0개 이상의 헤더들
- 일반 헤더

  - ex. Date 헤더: 메시지가 만들어진 일시
  - `Date: Tue, 3, Oct 1974 02:16:00 GMT`

- 요청 헤더

  - `Accept: */*`

- 응답 헤더

  - `Server: Tiki-Hut/1.0`

- Entity 헤더

  - `Content-Type: text/html; charset=utf-8`

- 확장 헤더

<br>

### 3.3.9 엔터티 본문

- 엔터티 본문은 임의의 데이터 블록을 포함한다.
