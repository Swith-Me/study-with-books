## 07. 오류 처리

### 들어가면서

- 상당수 코드 기반은 전적으로 오류 처리 코드에 좌우된다.
- 오류 처리는 중요하지만 오류 처리 코드로 인해 프로그램 논리를 이해하기 어려워진다면 깨끗한 코드라 부르기 어렵다.
- 이 장에서는 우아하고 고상하게 오류를 처리하는 기법과 고려 사항 몇 가지를 소개한다.

<br>

### 오류 코드보다 예외를 사용하라

- 오류가 발생하면 예외를 던지는 편이 낫다.
- 호출자 코드가 더 깔끔해진다. (논리가 오류 코드와 뒤섞이지 않음)

<br>

### Try-Catch-Finally 문부터 작성하라

- 예외가 발생하는 코드를 잘 때는 `try-catch-finally` 문으로 시작하는 편이 낫다.
- 강제로 예외를 일으키는 테스트 케이스를 작성한 후 테스트를 통과하게 코드를 작성하자.
- 자연스럽게 `try` 블록의 트랜잭션 범위부터 구현하게 되므로 범위 내에서 트랜잭션 본질을 유지하기 쉬워진다.

<br>

### 미확인 예외를 사용하라

- 때로는 확인된 예외도 유용하다.
- 하지만 일반적인 애플리케이션에서는 의존성이라는 비용이 이익보다 크다.(득보다 실이 더 큼)

ex)

1. 최하위 함수를 변경해 새로운 오류를 던진다고 가정하자.
2. 확인된 오류를 던진다면 함수는 선언부에 `throws` 절을 추가해야 한다.
3. 그러면 변경한 함수가 호출하는 함수 모두를 수정해야 한다.
4. 확인된 예외가 캡슐화를 깨버리게 된다.

<br>

### 예외에 의미를 제공하라

- 예외를 던질 때 전후 상황을 충분히 덧붙인다면, 오류가 발생한 원인과 위치를 찾기 쉬워진다.
- 오류 메세지에 정보를 담아 예외와 함께 던진다.

<br>

### 호출자를 고려해 예외 클래스를 정의하라

- 오류를 분류하는 방법은 수없이 많다. (ex. 발생한 위치, 컴포넌트, 유형 등등)
- 예외 클래스가 하나만 있어도 충분한 코드라면
  - 예외 클래스에 포함된 정보로 오류를 구분해도 OK
- 한 예외는 잡아내고 다른 예외를 무시해도 괜찮은 경우라면
  - 여러 예외 클래스를 사용한다.

<br>

### 정상 흐름을 정의하라

- 대부분의 경우, 코드 위에 처리기를 정의해 중단된 계산을 처리한다.
- 특수 사례 패턴에서는 클라이언트 코드가 예외적인 상황을 처리할 필요가 없어진다.

**특수 사례 패턴이란?**  
클래스를 만들거나 객체를 조작해 특수 사례를 처리하는 방식

<br>

### `null`을 반환하지 마라

- 우리는 흔히 저지르는 바람에 오류를 유발하기도 한다.
- `null`을 반환하는 습관
  - `null`을 반환하는 코드는 일거리를 늘릴 뿐만 아니라 호출자에게 문제를 떠넘긴다.
  - 메서드에서 `null`을 반환하고픈 유혹이 든다면 그 대신 예외를 던지거나 특수 사례 객체를 반환한다.

<br>

### `null`을 전달하지 마라

- 메서드에서 `null`을 반환하는 것보다 메서드로 `null`을 전달하는 방식이 더 나쁘다.
- 대다수 프로그래밍 언어는 호출자가 실수로 넘기는 `null`을 적절히 처리하는 방법이 없다.
- 이런 정책을 따르면 그만큼 부주의한 실수를 저지를 확률도 작아진다.

<br>

### 결론

- 깨끗한 코드는 읽기도 좋아야 하지만 안정성도 높아야 한다.
- 오류 처리를 프로그램 논리와 분리하면 독립적인 추론이 가능해지며 코드 유지보수성도 크게 높아진다.

<br>

### 느낀점

- 평소에 오류 처리에 대해서 중요성을 느끼지 못했었다.
- 이번 장을 읽으면서 특히 `null`을 반환, 전달하는 것을 피해야 한다는 것을 알게되서 좋았다.
